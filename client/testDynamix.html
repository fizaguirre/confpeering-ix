<head>
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Expires" content="-1">
  <title>Dynamix</title>
</head>

<body>
	{{#if currentUser}}
	{{> hello}}
  		<table border=1>
  			<tr>
  				<td>
  					{{> registerAnOffer}}
  				</td>
  				<td>
  					<table border=1 >
  						<tr valign="top">
  							<td>
  								{{> offer}}
  							</td>
  						</tr>
  						<tr>
  							<td>
  								{{> shareOffers}}
  							</td>
  						</tr>
  					</table>
  				</td>
  			</tr>
  			<tr>
  				<td>
  					{{> searchOffers}}
  				</td>
  				<td>
  					{{> searchOffersResult}}
  				</td>
  			</tr>
  			<tr>
  				<td>
  				{{> proposals}}
  				</td>
  				<td>
  					{{> contracts}}
  				</td>
  			</tr>
  		</table>
  		
		<br>
		<br>
  		{{else}}
  		<p><h1>Register</h1></p>
  		{{> register}}
  		<p><h1>Login</h1></p>
  		{{> login}}
  	{{/if}}
</body>

<template name="hello">
  <h1>Welcome to Dynamix!</h1><br>
  {{#if currentUser}}
  <h4>{{currentUser.username}}</h4>
  {{/if}}
  <button class="logout">Logout</button>
</template>

<template name="register">
	<form>
		<label for="emailReg">Email</label>
		<input type="text" name="emailReg"><br>
		<label for="passlReg">Password</label>
		<input type="password" name="passlReg"><br>
		<input type="submit" name="registerSubmit" value="Register"><br>
	</form>
</template>

<template name="login">
	<form>
		<label for="emailLogin">Email</label>
		<input type="text" name="emailLogin"><br>
		<label for="passwordLogin">Password</label>
		<input type="password" name="passwordLogin"><br>
		<input type="submit" name="loginSubmit" value="Login"><br>
	</form>
</template>

<template name="registerAnOffer">
	<form>
		<h4>Register an offer</h4>
		<label for="aspath">aspath*</label>
		<!--
		<input type="text" pattern="[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}/[0-9]{1,2}" name="aspath">
		-->
		<input type="text" name="aspath">
		<label for="bwidth">bwidth</label>
		<input type="text" name="bwidth">
		<label for="latency">latency</label>
		<input type="text" name="latency">
		<label for="pkt_loss">pkt_loss</label>
		<input type="text" name="pkt_loss">
		<label for="jitter">jitter</label>
		<input type="text" name="jitter">
		<label for="repair">repair</label>
		<input type="text" name="repair">
		<label for="guarantee">guarantee</label>
		<input type="text" name="guarantee">
		<label for="availability">availability</label>
		<input type="text" name="availability"><label for="billing">billing</label>
		<input type="text" name="billing">
		<label for="ingress">ingress</label>
		<input type="text" name="ingress">
		<label for="egress">egress</label>
		<input type="text" name="egress">
		<label for="lengh">lengh</label>
		<input type="text" name="lengh">
		<br>
		<input type="submit" name="registerOfferSubmit" value="Register offer">
	</form>
</template>

<template name="offer">
	<p><h2>My Offers</h2><p>
	<table border=1>
		<tr>
			<th><label>user</label></th>
			<th><label>aspath</label></th>
			<th><label>bwidth</label></th>
			<th><label>latency</label></th>
			<th><label>pkt_loss</label></th>
			<th><label>jitter</label></th>
			<th><label>repair</label></th>
			<th><label>guarantee</label></th>
			<th><label>availability</label></th>
			<th><label>billing</label></th>
			<th><label>ingress</label></th>
			<th><label>egress</label></th>
			<th><label>lengh</label><</th>			
		</tr>
		{{#each offers}}
		<tr>
			<td>{{userId}}</td>
			<td>{{aspath}}</td>
			<td>{{bwidth}}</td>
			<td>{{latency}}</td>
			<td>{{pkt_loss}}</td>
			<td>{{jitter}}</td>
			<td>{{repair}}</td>
			<td>{{guarantee}}</td>
			<td>{{availability}}</td>
			<td>{{billing}}</td>
			<td>{{ingress}}</td>
			<td>{{egress}}</td>
			<td>{{lengh}}</td>
		</tr>
		{{/each}}
	</table>
</template>

<template name="shareOffers">
	<h2>Share offers</h2>
	<form>
		<label for="asToShare">AS</label>
		<input type="text" name="as_share">
		<input type="submit" name="shareOffersSubmit" value="Share">
	</form>
</template>

<template name="searchOffers">
	<form>
		<h4>Search for an offer</h4>
		<label for="aspath3">aspath*</label>
		<input type="text" name="aspath3">
		<br>
		<input type="submit" name="searchOffersSubmit" value="Search">
	</form>
</template>

<template name="searchOffersResult">
	<p><h2>Search Result</h2><p>
	<table border=1>
		<tr>
			<th><label>id</label></th>
			<th><label>user</label></th>
			<th><label>aspath</label></th>
			<th><label>bwidth</label></th>
			<th><label>latency</label></th>
			<th><label>pkt_loss</label></th>
			<th><label>jitter</label></th>
			<th><label>repair</label></th>
			<th><label>guarantee</label></th>
			<th><label>availability</label></th>
			<th><label>billing</label></th>
			<th><label>ingress</label></th>
			<th><label>egress</label></th>
			<th><label>lengh</label><</th>
			<th><label>actions</label></th>
		</tr>
		{{#each offersResult}}
		<tr>
			<td>{{_id}}</td>
			<td>{{userId}}</td>
			<td>{{aspath}}</td>
			<td>{{bwidth}}</td>
			<td>{{latency}}</td>
			<td>{{pkt_loss}}</td>
			<td>{{jitter}}</td>
			<td>{{repair}}</td>
			<td>{{guarantee}}</td>
			<td>{{availability}}</td>
			<td>{{billing}}</td>
			<td>{{ingress}}</td>
			<td>{{egress}}</td>
			<td>{{lengh}}</td>
			<td><button id="sendProposal" value={{_id}}>Send a proposal</button></td>
		</tr>
		{{/each}}
	</table>
</template>

<template name="proposals">
	<h2>Proposals</h2>
	<table border=1>
		<tr>
			<th><label>Costumer</label></th>
			<th><label>Provider</label></th>
			<th><label>Offer</label></th>
			<th><label>Proposal</label></th>
			<th><label>State</label></th>
			<th><label>Actions</label></th>
		</tr>
		{{#each proposal}}
		<tr>
			<td>{{costumer}}</td>
			<td>{{provider}}</td>
			<td>{{offer_id}}</td>
			<td>{{propdoc}}</td>
			{{#with states state}}
				<td>{{desc}}</td>
			{{/with}}
			<td>
				<table>
					{{#each actions _id}}
					<tr>
						<td>
							<button id={{cod}} value={{../_id}}>{{desc}}</button>
						</td>
					</tr>
					{{/each}}
				</table>
			</td>
		</tr>
		{{/each}}
	</table>
</template>

<template name="contracts">
	<h2>Contracts</h2>
	<table border=1>
		<tr>
			<th><label>Costumer</label></th>
			<th><label>Provider</label></th>
			<th><label>Contract</label></th>
			<th><label>Provider Signature</label></th>
			<th><label>Costumer Signature</label></th>
			<th><label>State</label></th>
			<th><label>Actions</label></th>
		</tr>
		{{#each contract}}
		<tr>
			<td>{{costumer}}</td>
			<td>{{provider}}</td>
			<td>{{contdoc}}</td>
			{{#if providerSignature}}
				<td><button id="verProviderSign" value={{_id}}>Verify Provider Signature</button></td>
			{{else}}
				<td></td>
			{{/if}}
			{{#if costumerSignature}}
				<td><button id="verCostumerSign" value={{_id}}>Verify Costumer Signature</button></td>
			{{else}}
				<td></td>
			{{/if}}
			{{#with states state}}
				<td>{{desc}}</td>
			{{/with}}
			<td>
				<table>
					{{#each actions _id}}
					<tr>
						<td>
							<button id={{cod}} value={{../_id}}>{{desc}}</button>
						</td>
					</tr>
					{{/each}}
				</table>
			</td>
		</tr>
		{{/each}}
	</table>
</template>